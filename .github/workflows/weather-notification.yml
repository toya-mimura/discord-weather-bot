name: 天気予報配信

on:
  schedule:
    # 日本時間 AM 5:00 = UTC 20:00 (前日)
    - cron: '0 20 * * *'
  workflow_dispatch:  # 手動実行も可能

jobs:
  send-weather:
    runs-on: ubuntu-latest
    
    steps:
      - name: チェックアウト
        uses: actions/checkout@v4
      
      - name: Python環境のセットアップ
        uses: actions/setup-python@v5
        with:
          python-version: '3.11'
      
      - name: 依存関係のインストール
        run: |
          python -m pip install --upgrade pip
          pip install -r requirements.txt
      
      - name: 天気情報の取得と配信
        env:
          OWM_API_KEY: ${{ secrets.OWM_API_KEY }}
          LATITUDE: ${{ secrets.LATITUDE }}
          LONGITUDE: ${{ secrets.LONGITUDE }}
          DISCORD_WEBHOOK_URL: ${{ secrets.DISCORD_WEBHOOK_URL }}
        run: |
          python weather_bot.py
